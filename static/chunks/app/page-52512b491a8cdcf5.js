(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1799:function(e,s,t){Promise.resolve().then(t.bind(t,3313))},3313:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var n=t(7437),a=t(2265);function l(e){let{task:s,setTaskModal:t,setErrorMessage:a}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"rounded-[5px] border-neutral border-[1px] btn btn-outline flex-nowrap justify-between",children:[(0,n.jsx)("button",{className:"truncate w-full",onClick:()=>t(s.id),children:s.name}),(0,n.jsx)("input",{type:"checkbox",defaultChecked:s.done,className:"checkbox checkbox-accent",onChange:async e=>{let t=e.currentTarget.checked,n=(await fetch("https://api.silencecraft.ru/api/setDone",{method:"POST",body:JSON.stringify({id:s.id,done:t})})).json;n.error&&a(n.error)}})]})})}function r(e){let{goal:s,tasks:t,allTasks:l,setErrorMessage:r,setGoals:c,setTasks:i}=e,[o,d]=(0,a.useState)(),[u,p]=(0,a.useState)(),[x,f]=(0,a.useState)();return(0,a.useEffect)(()=>{d(""),p(""),f("")},[]),(0,n.jsxs)("div",{className:"bg-secondary rounded-[10px] py-4 px-6 w-full",children:[(0,n.jsx)("p",{className:"text-4xl mb-4",children:"Новая задача"}),(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)("input",{placeholder:"Название",className:"input ".concat(o?"":"input-error"),onInput:e=>d(e.currentTarget.value)}),(0,n.jsx)("input",{placeholder:"Дата",className:"input ".concat(u?"":"input-error"),type:"date",onInput:e=>p(e.currentTarget.value)}),(0,n.jsx)("input",{placeholder:"Вес",className:"input ".concat(x?"":"input-error"),onInput:e=>f(e.currentTarget.value)}),(0,n.jsx)("button",{className:"btn btn-accent",onClick:async()=>{if(!(o&&u&&x))return;let e={name:o,date:u,weight:x,goal:s.id,tasks:"{".concat(t.map(e=>e.id).join(","),"}")},n=(await fetch("https://api.silencecraft.ru/api/setTask",{method:"POST",body:JSON.stringify(e)})).json;if(n.error)r(n.error);else{let e=l[l.length-1].id+1;i(s=>[...s,{name:o,date:u,weight:x,id:e}]);let t={...s,tasks:[...(null==s?void 0:s.tasks)||[],e]};c(e=>[...e.filter(e=>e.id!==s.id),t])}},children:"Добавить"})]})]})}function c(e){let{goal:s,tasks:t,setGoals:a,setTaskModal:c,setErrorMessage:i,setTasks:o,allTasks:d}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("dialog",{className:"modal",id:"newTaskModal",children:(0,n.jsxs)("div",{className:"modal-box",children:[(0,n.jsx)(r,{goal:s,allTasks:d,tasks:t,setTasks:o,setGoals:a,setErrorMessage:i}),(0,n.jsx)("div",{className:"modal-action",children:(0,n.jsx)("form",{method:"dialog",children:(0,n.jsx)("button",{className:"btn",children:" Закрыть"})})})]})}),(0,n.jsxs)("div",{className:"bg-secondary rounded-[10px] py-4 px-6 w-full sm:w-1/3",children:[(0,n.jsxs)("p",{className:"text-4xl",children:["Цель: ",(0,n.jsx)("span",{className:"underline",children:null==s?void 0:s.name})]}),(0,n.jsx)("p",{className:"mt-2",children:"Задачи:"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-1",children:[null==t?void 0:t.map(e=>(0,n.jsx)(l,{task:e,setTaskModal:c,setErrorMessage:i},e.id)),(0,n.jsx)("button",{className:"btn btn-accent",onClick:()=>{var e,s;return null===(s=document)||void 0===s?void 0:null===(e=s.getElementById("newTaskModal"))||void 0===e?void 0:e.showModal()},children:"Добавить задачу"})]})]})]})}function i(e){let{setGoals:s,setSelectedGoal:t,setErrorMessage:l}=e,[r,c]=(0,a.useState)();return(0,a.useEffect)(()=>{c("")},[]),(0,n.jsxs)("div",{className:"bg-secondary rounded-[10px] py-4 px-6 w-full sm:w-1/3",children:[(0,n.jsx)("p",{className:"text-4xl mb-4",children:"Новая цель"}),(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)("input",{placeholder:"Название",className:"input ".concat(r?"":"input-error"),onInput:e=>c(e.currentTarget.value)}),(0,n.jsx)("button",{className:"btn btn-accent",onClick:async()=>{if(!r)return;let e={name:r},n=(await fetch("https://api.silencecraft.ru/api/setGoal",{method:"POST",body:JSON.stringify(e)})).json;n.error?l(n.error):(t(n.id),s(s=>[...s,{...e,id:n.id}]))},children:"Добавить"})]})]})}function o(){var e;let[s,t]=(0,a.useState)(null),[l,r]=(0,a.useState)([]),[o,d]=(0,a.useState)([]),[u,p]=(0,a.useState)(0),[x,f]=(0,a.useState)(!1),[h,m]=(0,a.useState)(null);return(0,a.useEffect)(()=>{(async()=>{let e=await fetch("https://api.silencecraft.ru//api/getData");try{let s=await e.json();s.goals&&d(s.goals),s.tasks&&r(s.tasks)}catch(e){}})()},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("header",{className:"p-4",children:(0,n.jsx)("p",{className:"text-xl font-bold text-pretty text-center",children:"Формирование и достижение цели"})}),(0,n.jsx)("main",{children:(0,n.jsx)("div",{className:"flex flex-col justify-center items-center min-h-screen p-8",children:(0,n.jsx)("section",{children:(0,n.jsxs)("div",{className:"flex flex-col justify-center items-center lg:flex-row gap-4 w-full",children:[(0,n.jsxs)("div",{className:"border-secondary border-[1px] rounded-[10px] p-4",children:[(0,n.jsx)("p",{children:"Цели:"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[null==o?void 0:o.map((e,s)=>(0,n.jsx)("button",{className:"btn ".concat(u===s?"btn-secondary":"btn-outline"),onClick:()=>{p(s),x&&f(!1)},children:e.name},e.id)),(0,n.jsx)("button",{className:"btn btn-accent",onClick:()=>{f(!0)},children:"Добавить цель"})]})]}),x?(0,n.jsx)(i,{setGoals:d,setSelectedGoal:p,setErrorMessage:t}):(0,n.jsx)(c,{goal:o[u],setGoals:d,setErrorMessage:t,setTaskModal:m,setTasks:r,allTasks:l,tasks:null==l?void 0:l.filter(e=>{var s,t;return null===(t=o[u])||void 0===t?void 0:null===(s=t.tasks)||void 0===s?void 0:s.includes(null==e?void 0:e.id)})},null===(e=o[u])||void 0===e?void 0:e.id)]})})})})]})}},622:function(e,s,t){"use strict";var n=t(2265),a=Symbol.for("react.element"),l=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,c=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(e,s,t){var n,l={},o=null,d=null;for(n in void 0!==t&&(o=""+t),void 0!==s.key&&(o=""+s.key),void 0!==s.ref&&(d=s.ref),s)r.call(s,n)&&!i.hasOwnProperty(n)&&(l[n]=s[n]);if(e&&e.defaultProps)for(n in s=e.defaultProps)void 0===l[n]&&(l[n]=s[n]);return{$$typeof:a,type:e,key:o,ref:d,props:l,_owner:c.current}}s.Fragment=l,s.jsx=o,s.jsxs=o},7437:function(e,s,t){"use strict";e.exports=t(622)}},function(e){e.O(0,[971,938,744],function(){return e(e.s=1799)}),_N_E=e.O()}]);